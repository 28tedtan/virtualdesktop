<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 95 Desktop</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
    <div class="desktop" id="desktop">
        <div class="desktop-icons">
            <div class="desktop-icon" data-window="my-computer">
                <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect width='14' height='8' x='5' y='2' rx='2'/><rect width='20' height='8' x='2' y='14' rx='2'/><path d='M6 18h2'/><path d='M12 18h6'/></svg>" alt="Computer">
                <span>My Computer</span>
            </div>
            <div class="desktop-icon" data-window="boogle">
                <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z'/><polyline points='14,2 14,8 20,8'/></svg>" alt="Boogle">
                <span>Boogle</span>
            </div>
            <div class="desktop-icon" data-window="spotify">
                <img src="https://cdn4.iconfinder.com/data/icons/social-media-and-logos-12/32/Logo_Spotify-1024.png" alt="Spotify">
                <span>Spotify</span>
            </div>
            <div class="desktop-icon" data-window="vinyl-player">
                <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><circle cx='12' cy='12' r='10'/><circle cx='12' cy='12' r='3'/><path d='M12 2v4'/><path d='M12 18v4'/><path d='M2 12h4'/><path d='M18 12h4'/></svg>" alt="Vinyl Player">
                <span>Vinyl Player</span>
            </div>
            <div class="desktop-icon" data-window="recycle-bin">
                <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M3 6h18'/><path d='M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6'/><path d='M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2'/></svg>" alt="Recycle Bin">
                <span>Recycle Bin</span>
            </div>
            <div class="desktop-icon" onclick="openThemeCustomizer()">
                <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z'/><circle cx='12' cy='12' r='3'/></svg>" alt="Settings">
                <span>Settings</span>
            </div>
        </div>

        <!-- Windows -->
        <div class="window" id="my-computer" data-title="My Computer">
            <div class="window-header">
                <div class="window-title">My Computer</div>
                <div class="window-controls">
                    <div class="window-control" onclick="minimizeWindow('my-computer')">_</div>
                    <div class="window-control" onclick="closeWindow('my-computer')">√ó</div>
                </div>
            </div>
            <div class="window-content">
                <p>This is the My Computer window. Here you would see your drives and system information.</p>
                <br>
                <p>üíæ (A:) Floppy Disk</p>
                <p>üíø (C:) Hard Drive</p>
                <p>üíø (D:) CD-ROM Drive</p>
            </div>
            <div class="resize-handle resize-n"></div>
            <div class="resize-handle resize-s"></div>
            <div class="resize-handle resize-e"></div>
            <div class="resize-handle resize-w"></div>
            <div class="resize-handle resize-ne"></div>
            <div class="resize-handle resize-nw"></div>
            <div class="resize-handle resize-se"></div>
            <div class="resize-handle resize-sw"></div>
        </div>

        <div class="window" id="boogle" data-title="Boogle - Internet Explorer">
            <div class="window-header">
                <div class="window-title">Boogle - Internet Explorer</div>
                <div class="window-controls">
                    <div class="window-control" onclick="minimizeWindow('boogle')">_</div>
                    <div class="window-control" onclick="closeWindow('boogle')">√ó</div>
                </div>
            </div>
            <div class="window-content" style="padding: 0;">
                <!-- Title Bar -->
                <div class="title-bar">
                    <div class="title-bar-icon"></div>
                    <div class="title-text">Internet Explorer</div>
                    <div class="window-controls">
                        <div class="control-btn" onclick="minimizeWindow('boogle')">_</div>
                        <div class="control-btn" onclick="maximizeWindow('boogle')">‚ñ°</div>
                        <div class="control-btn" onclick="closeWindow('boogle')">√ó</div>
                    </div>
                </div>

                <!-- Menu Bar -->
                <div class="menu-bar">
                    <div class="dropdown">
                        <div class="menu-item" onclick="toggleDropdown(this)">File</div>
                        <div class="dropdown-content">
                            <a href="#" onclick="newWindow()">New Window</a>
                            <a href="#" onclick="openFile()">Open...</a>
                            <a href="#" onclick="saveAs()">Save As...</a>
                            <a href="#" onclick="print()">Print...</a>
                            <a href="#" onclick="closeWindow('boogle')">Close</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <div class="menu-item" onclick="toggleDropdown(this)">Edit</div>
                        <div class="dropdown-content">
                            <a href="#" onclick="cut()">Cut</a>
                            <a href="#" onclick="copy()">Copy</a>
                            <a href="#" onclick="paste()">Paste</a>
                            <a href="#" onclick="selectAll()">Select All</a>
                            <a href="#" onclick="find()">Find...</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <div class="menu-item" onclick="toggleDropdown(this)">View</div>
                        <div class="dropdown-content">
                            <a href="#" onclick="refresh()">Refresh</a>
                            <a href="#" onclick="viewSource()">Source</a>
                            <a href="#" onclick="fullScreen()">Full Screen</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <div class="menu-item" onclick="toggleDropdown(this)">Favorites</div>
                        <div class="dropdown-content">
                            <a href="#" onclick="addToFavorites()">Add to Favorites...</a>
                            <a href="#" onclick="organizeFavorites()">Organize Favorites...</a>
                            <a href="#" onclick="navigateTo('http://www.microsoft.com')">Microsoft</a>
                            <a href="#" onclick="navigateTo('http://www.yahoo.com')">Yahoo!</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <div class="menu-item" onclick="toggleDropdown(this)">Tools</div>
                        <div class="dropdown-content">
                            <a href="#" onclick="internetOptions()">Internet Options...</a>
                            <a href="#" onclick="windowsUpdate()">Windows Update</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <div class="menu-item" onclick="toggleDropdown(this)">Help</div>
                        <div class="dropdown-content">
                            <a href="#" onclick="showHelp()">Help Topics</a>
                            <a href="#" onclick="aboutIE()">About Internet Explorer</a>
                        </div>
                    </div>
                </div>

                <!-- Toolbar -->
                <div class="toolbar">
                    <div class="toolbar-btn" onclick="goBack()" title="Back">‚óÄ</div>
                    <div class="toolbar-btn" onclick="goForward()" title="Forward">‚ñ∂</div>
                    <div class="toolbar-btn" onclick="stopLoading()" title="Stop">‚ñ†</div>
                    <div class="toolbar-btn" onclick="refresh()" title="Refresh">‚Üª</div>
                    <div class="toolbar-btn" onclick="goHome()" title="Home">üè†</div>
                    <div style="width: 2px; height: 20px; background-color: #808080; margin: 0 2px;"></div>
                    <div class="toolbar-btn" onclick="search()" title="Search">üîç</div>
                    <div class="toolbar-btn" onclick="showFavorites()" title="Favorites">‚≠ê</div>
                    <div class="toolbar-btn" onclick="showHistory()" title="History">üìã</div>
                    <div style="width: 2px; height: 20px; background-color: #808080; margin: 0 2px;"></div>
                    <div class="toolbar-btn" onclick="print()" title="Print">üñ®</div>
                </div>

                <!-- Address Bar -->
                <div class="address-bar">
                    <div class="address-label">Address:</div>
                    <input type="text" class="address-input" id="addressInput" value="about:blank" onkeypress="handleAddressEnter(event)">
                    <div class="go-btn" onclick="navigate()">Go</div>
                </div>

                <!-- Content Area -->
                <div class="content-area">
                    <div id="browserContent" class="homepage">
                        <h1>Welcome to Internet Explorer</h1>
                        <p>The best way to experience the web.</p>
                        
                        <div class="favorites-section">
                            <h3>Quick Links</h3>
                            <a href="#" class="favorite-link" onclick="navigateTo('http://www.microsoft.com')">Microsoft Corporation</a>
                            <a href="#" class="favorite-link" onclick="navigateTo('http://www.msn.com')">MSN.com</a>
                            <a href="#" class="favorite-link" onclick="navigateTo('http://www.hotmail.com')">Hotmail</a>
                            <a href="#" class="favorite-link" onclick="navigateTo('http://www.windows.com')">Windows</a>
                        </div>
                        
                        <div class="favorites-section">
                            <h3>Search the Web</h3>
                            <input type="text" id="searchInput" placeholder="Enter search terms..." style="width: 300px; padding: 4px; margin-right: 10px;">
                            <button onclick="performSearch()" style="padding: 4px 12px;">Search</button>
                        </div>
                    </div>
                </div>

                <!-- Status Bar -->
                <div class="status-bar">
                    <div class="status-text" id="statusText">Done</div>
                    <div class="progress-section">
                        <div class="loading-animation" id="loadingAnimation"></div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="resize-handle resize-n"></div>
            <div class="resize-handle resize-s"></div>
            <div class="resize-handle resize-e"></div>
            <div class="resize-handle resize-w"></div>
            <div class="resize-handle resize-ne"></div>
            <div class="resize-handle resize-nw"></div>
            <div class="resize-handle resize-se"></div>
            <div class="resize-handle resize-sw"></div>
        </div>

        <div class="window" id="recycle-bin" data-title="Recycle Bin">
            <div class="window-header">
                <div class="window-title">Recycle Bin</div>
                <div class="window-controls">
                    <div class="window-control" onclick="minimizeWindow('recycle-bin')">_</div>
                    <div class="window-control" onclick="closeWindow('recycle-bin')">√ó</div>
                </div>
            </div>
            <div class="window-content">
                <p>The Recycle Bin is empty.</p>
                <br>
                <p>To restore an item, select it and click Restore.</p>
                <p>To permanently delete an item, select it and press Delete.</p>
            </div>
            <div class="resize-handle resize-n"></div>
            <div class="resize-handle resize-s"></div>
            <div class="resize-handle resize-e"></div>
            <div class="resize-handle resize-w"></div>
            <div class="resize-handle resize-ne"></div>
            <div class="resize-handle resize-nw"></div>
            <div class="resize-handle resize-se"></div>
            <div class="resize-handle resize-sw"></div>
        </div>

        <div class="window" id="spotify" data-title="Spotify">
            <div class="window-header">
                <div class="window-title">Spotify</div>
                <div class="window-controls">
                    <div class="window-control" onclick="minimizeWindow('spotify')">_</div>
                    <div class="window-control" onclick="closeWindow('spotify')">√ó</div>
                </div>
            </div>
            <div class="window-content" style="padding: 0; overflow: hidden;">
                <iframe 
                    src="https://open.spotify.com/embed/playlist/2d7468fnsy6P8x8aLm0A0u" 
                    width="100%" 
                    height="100%" 
                    frameborder="0" 
                    allowtransparency="true" 
                    allow="encrypted-media"
                    style="border: none;"
                ></iframe>
            </div>
            <div class="resize-handle resize-n"></div>
            <div class="resize-handle resize-s"></div>
            <div class="resize-handle resize-e"></div>
            <div class="resize-handle resize-w"></div>
            <div class="resize-handle resize-ne"></div>
            <div class="resize-handle resize-nw"></div>
            <div class="resize-handle resize-se"></div>
            <div class="resize-handle resize-sw"></div>
        </div>

        <div class="window" id="vinyl-player" data-title="Vinyl Player">
            <div class="window-header">
                <div class="window-title">Vinyl Player</div>
                <div class="window-controls">
                    <div class="window-control" onclick="minimizeWindow('vinyl-player')">_</div>
                    <div class="window-control" onclick="closeWindow('vinyl-player')">√ó</div>
                </div>
            </div>
            <div class="window-content" style="padding: 0; overflow: hidden;">
                <div class="player">
                    <div class="player-content">
                        <div class="turntable">
                            <div class="vinyl"><div class="grooves"></div><div class="label"></div></div>
                            <div class="tone-arm"><div class="tone-arm-base"></div><div class="tone-arm-body"><div class="tone-arm-head"><div class="stylus"></div></div></div></div>
                        </div>
                        <div class="music-details">
                            <img class="cover-art" src="https://images.pexels.com/photos/167092/pexels-photo-167092.jpeg" alt="Album cover">
                            <div class="song-info">
                                <h2>Vinyl Player</h2>
                                <p>Enter a YouTube URL to start playing music!</p>
                                <div class="input-container">
                                    <label for="youtube-url" class="input-label">YouTube URL</label>
                                    <input type="text" id="youtube-url" class="youtube-input" placeholder="URL Link">
                                    <button id="load-music" class="load-button">Load Music</button>
                                    <div id="status" class="status"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="controls">
                        <div class="progress-bar"><div class="progress"></div></div>
                        <div class="control-buttons">
                            <span class="time">0:00 / 0:00</span>
                            <div class="buttons">
                                <button class="fullscreen-button" title="Toggle Fullscreen">‚õ∂</button>
                                <button class="play-button" disabled>‚ñ∂</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="youtube-container"><div id="youtube-player"></div></div>
            </div>
            <div class="resize-handle resize-n"></div>
            <div class="resize-handle resize-s"></div>
            <div class="resize-handle resize-e"></div>
            <div class="resize-handle resize-w"></div>
            <div class="resize-handle resize-ne"></div>
            <div class="resize-handle resize-nw"></div>
            <div class="resize-handle resize-se"></div>
            <div class="resize-handle resize-sw"></div>
        </div>

        <div class="window" id="notepad" data-title="Notepad">
            <div class="window-header">
                <div class="window-title">Notepad</div>
                <div class="window-controls">
                    <div class="window-control" onclick="minimizeWindow('notepad')">_</div>
                    <div class="window-control" onclick="closeWindow('notepad')">√ó</div>
                </div>
            </div>
            <div class="window-content">
                <textarea style="width: 100%; height: 100%; border: 1px inset #c0c0c0; background: white; font-family: 'Courier New', monospace; font-size: 12px; resize: none;" placeholder="Type your text here..."></textarea>
            </div>
            <div class="resize-handle resize-n"></div>
            <div class="resize-handle resize-s"></div>
            <div class="resize-handle resize-e"></div>
            <div class="resize-handle resize-w"></div>
            <div class="resize-handle resize-ne"></div>
            <div class="resize-handle resize-nw"></div>
            <div class="resize-handle resize-se"></div>
            <div class="resize-handle resize-sw"></div>
        </div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar">
        <img src="https://i.ibb.co/XfrfB1ZS/Screenshot-2025-06-10-at-3-43-08-PM.png" alt="Logo" class="taskbar-logo">
        <div class="start-button" id="start-button" onclick="toggleStartMenu()">Start</div>
        <div class="taskbar-buttons" id="taskbar-buttons"></div>
        <div class="confetti-button" onclick="triggerConfetti()">üéâ</div>
        <div class="taskbar-time" id="taskbar-time"></div>
    </div>

    <!-- Start Menu -->
    <div class="start-menu" id="start-menu">
        <div class="start-menu-header">Windows 95</div>
        <div class="start-menu-items">
            <div class="start-menu-item" onclick="openWindow('notepad'); toggleStartMenu();">
                <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z'/><polyline points='14,2 14,8 20,8'/></svg>" alt="Notepad">
                <span>Notepad</span>
            </div>
            <div class="start-menu-item" onclick="openThemeCustomizer(); toggleStartMenu();">
                <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z'/><circle cx='12' cy='12' r='3'/></svg>" alt="Settings">
                <span>Theme Settings</span>
            </div>
            <hr style="margin: 4px 0; border: 1px inset #c0c0c0;">
            <div class="start-menu-item" onclick="alert('Shutting down...'); toggleStartMenu();">
                <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M18.36 6.64a9 9 0 1 1-12.73 0'/><path d='M12 2v10'/></svg>" alt="Shutdown">
                <span>Shut Down...</span>
            </div>
        </div>
    </div>

    <!-- Theme Customizer -->
    <div class="theme-customizer" id="theme-customizer">
        <div class="theme-customizer-header">
            <div>Theme Customizer</div>
            <div class="window-control" onclick="closeThemeCustomizer()">√ó</div>
        </div>
        <div class="theme-customizer-content">
            <div class="theme-section">
                <h3>Preset Themes</h3>
                <div class="preset-themes">
                    <div class="preset-button" onclick="applyPresetTheme('classic')">Classic</div>
                    <div class="preset-button" onclick="applyPresetTheme('dark')">Dark</div>
                    <div class="preset-button" onclick="applyPresetTheme('green')">Green</div>
                </div>
            </div>

            <div class="theme-section">
                <h3>Desktop</h3>
                <div class="color-input-group">
                    <label>Background:</label>
                    <input type="color" id="desktop-bg" value="#008080" onchange="updateTheme()">
                </div>
                <div class="color-input-group">
                    <label>Icon Text:</label>
                    <input type="color" id="icon-text" value="#ffffff" onchange="updateTheme()">
                </div>
                <div class="wallpaper-section">
                    <label>Custom Wallpaper:</label>
                    <input type="file" id="wallpaper-upload" accept="image/*" onchange="handleWallpaperUpload(event)">
                    <button onclick="document.getElementById('wallpaper-upload').click()" class="theme-button">Choose Image</button>
                    <button onclick="removeWallpaper()" class="theme-button">Remove Wallpaper</button>
                </div>
            </div>

            <div class="theme-section">
                <h3>Windows</h3>
                <div class="color-input-group">
                    <label>Background:</label>
                    <input type="color" id="window-bg" value="#c0c0c0" onchange="updateTheme()">
                </div>
                <div class="color-input-group">
                    <label>Title Bar:</label>
                    <input type="color" id="title-bar" value="#000080" onchange="updateTheme()">
                </div>
            </div>

            <div class="theme-section">
                <h3>Taskbar</h3>
                <div class="color-input-group">
                    <label>Background:</label>
                    <input type="color" id="taskbar-bg" value="#c0c0c0" onchange="updateTheme()">
                </div>
            </div>

            <div class="theme-buttons">
                <div class="theme-button" onclick="resetTheme()">Reset</div>
                <div class="theme-button" onclick="closeThemeCustomizer()">Close</div>
            </div>
        </div>
    </div>

    <script>
        let draggedWindow = null;
        let dragOffset = { x: 0, y: 0 };
        let resizingWindow = null;
        let resizeDirection = null;
        let resizeStart = { x: 0, y: 0, width: 0, height: 0, left: 0, top: 0 };
        let windowZIndex = 1000;
        let openWindows = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateTime();
            setInterval(updateTime, 1000);
            
            // Add click listeners to desktop icons
            document.querySelectorAll('.desktop-icon[data-window]').forEach(icon => {
                icon.addEventListener('click', function() {
                    const windowId = this.getAttribute('data-window');
                    openWindow(windowId);
                });
            });

            // Add window drag and resize functionality
            initializeWindows();
            
            // Close start menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.start-button') && !e.target.closest('.start-menu')) {
                    document.getElementById('start-menu').style.display = 'none';
                    document.getElementById('start-button').classList.remove('active');
                }
            });

            // Initialize vinyl player
            initializeVinylPlayer();
        });

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            document.getElementById('taskbar-time').textContent = timeString;
        }

        function toggleStartMenu() {
            const startMenu = document.getElementById('start-menu');
            const startButton = document.getElementById('start-button');
            
            if (startMenu.style.display === 'block') {
                startMenu.style.display = 'none';
                startButton.classList.remove('active');
            } else {
                startMenu.style.display = 'block';
                startButton.classList.add('active');
            }
        }

        function openWindow(windowId) {
            const window = document.getElementById(windowId);
            if (!window) return;

            window.style.display = 'block';
            window.style.zIndex = ++windowZIndex;
            
            // Position window with slight offset for multiple windows
            const offset = openWindows.length * 30;
            window.style.left = (100 + offset) + 'px';
            window.style.top = (100 + offset) + 'px';
            window.style.width = '400px';
            window.style.height = '300px';

            if (!openWindows.includes(windowId)) {
                openWindows.push(windowId);
                updateTaskbar();
            }

            focusWindow(windowId);
        }

        function closeWindow(windowId) {
            const window = document.getElementById(windowId);
            window.style.display = 'none';
            
            openWindows = openWindows.filter(id => id !== windowId);
            updateTaskbar();
        }

        function minimizeWindow(windowId) {
            const window = document.getElementById(windowId);
            window.style.display = 'none';
            updateTaskbar();
        }

        function restoreWindow(windowId) {
            const window = document.getElementById(windowId);
            window.style.display = 'block';
            focusWindow(windowId);
        }

        function focusWindow(windowId) {
            // Remove active class from all windows
            document.querySelectorAll('.window').forEach(w => {
                w.classList.remove('active');
                w.querySelector('.window-header').classList.add('inactive');
            });

            // Add active class to focused window
            const window = document.getElementById(windowId);
            window.classList.add('active');
            window.style.zIndex = ++windowZIndex;
            window.querySelector('.window-header').classList.remove('inactive');
            
            updateTaskbar();
        }

        function updateTaskbar() {
            const taskbarButtons = document.getElementById('taskbar-buttons');
            taskbarButtons.innerHTML = '';

            openWindows.forEach(windowId => {
                const window = document.getElementById(windowId);
                const title = window.getAttribute('data-title');
                const isVisible = window.style.display === 'block';
                const isActive = window.classList.contains('active');

                const button = document.createElement('div');
                button.className = 'taskbar-button' + (isActive && isVisible ? ' active' : '');
                button.textContent = title;
                button.onclick = () => {
                    if (isVisible) {
                        minimizeWindow(windowId);
                    } else {
                        restoreWindow(windowId);
                    }
                };
                
                taskbarButtons.appendChild(button);
            });
        }

        function initializeWindows() {
            document.querySelectorAll('.window').forEach(window => {
                const header = window.querySelector('.window-header');
                
                // Window dragging
                header.addEventListener('mousedown', function(e) {
                    if (e.target.closest('.window-control')) return;
                    
                    draggedWindow = window;
                    const rect = window.getBoundingClientRect();
                    dragOffset.x = e.clientX - rect.left;
                    dragOffset.y = e.clientY - rect.top;
                    
                    focusWindow(window.id);
                    e.preventDefault();
                });

                // Window resizing
                window.querySelectorAll('.resize-handle').forEach(handle => {
                    handle.addEventListener('mousedown', function(e) {
                        resizingWindow = window;
                        resizeDirection = this.className.split(' ')[1].replace('resize-', '');
                        
                        const rect = window.getBoundingClientRect();
                        resizeStart = {
                            x: e.clientX,
                            y: e.clientY,
                            width: rect.width,
                            height: rect.height,
                            left: rect.left,
                            top: rect.top
                        };
                        
                        focusWindow(window.id);
                        e.preventDefault();
                        e.stopPropagation();
                    });
                });

                // Focus window on click
                window.addEventListener('mousedown', function() {
                    focusWindow(window.id);
                });
            });

            // Global mouse events
            document.addEventListener('mousemove', function(e) {
                if (draggedWindow) {
                    const x = Math.max(0, e.clientX - dragOffset.x);
                    const y = Math.max(0, e.clientY - dragOffset.y);
                    draggedWindow.style.left = x + 'px';
                    draggedWindow.style.top = y + 'px';
                }

                if (resizingWindow) {
                    const deltaX = e.clientX - resizeStart.x;
                    const deltaY = e.clientY - resizeStart.y;
                    
                    let newWidth = resizeStart.width;
                    let newHeight = resizeStart.height;
                    let newLeft = resizeStart.left;
                    let newTop = resizeStart.top;

                    if (resizeDirection.includes('e')) {
                        newWidth = Math.max(200, resizeStart.width + deltaX);
                    }
                    if (resizeDirection.includes('w')) {
                        newWidth = Math.max(200, resizeStart.width - deltaX);
                        newLeft = resizeStart.left + deltaX;
                    }
                    if (resizeDirection.includes('s')) {
                        newHeight = Math.max(150, resizeStart.height + deltaY);
                    }
                    if (resizeDirection.includes('n')) {
                        newHeight = Math.max(150, resizeStart.height - deltaY);
                        newTop = resizeStart.top + deltaY;
                    }

                    resizingWindow.style.width = newWidth + 'px';
                    resizingWindow.style.height = newHeight + 'px';
                    resizingWindow.style.left = newLeft + 'px';
                    resizingWindow.style.top = newTop + 'px';
                }
            });

            document.addEventListener('mouseup', function() {
                draggedWindow = null;
                resizingWindow = null;
            });
        }

        // Theme functions
        function openThemeCustomizer() {
            document.getElementById('theme-customizer').style.display = 'block';
        }

        function closeThemeCustomizer() {
            document.getElementById('theme-customizer').style.display = 'none';
        }

        function updateTheme() {
            const desktopBg = document.getElementById('desktop-bg').value;
            const iconText = document.getElementById('icon-text').value;
            const windowBg = document.getElementById('window-bg').value;
            const titleBar = document.getElementById('title-bar').value;
            const taskbarBg = document.getElementById('taskbar-bg').value;

            // Update desktop background
            document.querySelector('.desktop').style.background = desktopBg;
            document.querySelector('.desktop').style.backgroundImage = 'none';
            
            // Update icon text color
            document.querySelectorAll('.desktop-icon span').forEach(span => {
                span.style.color = iconText;
            });

            // Update window colors
            document.querySelectorAll('.window').forEach(window => {
                window.style.backgroundColor = windowBg;
                window.style.borderColor = windowBg;
            });

            document.querySelectorAll('.window-content').forEach(content => {
                content.style.backgroundColor = windowBg;
            });

            document.querySelectorAll('.window-header:not(.inactive)').forEach(header => {
                header.style.background = `linear-gradient(90deg, ${titleBar}, ${titleBar}dd)`;
            });

            // Update taskbar colors
            document.querySelector('.taskbar').style.backgroundColor = taskbarBg;
            document.querySelectorAll('.taskbar-button, .start-button, .taskbar-time').forEach(el => {
                el.style.backgroundColor = taskbarBg;
            });
        }

        function handleWallpaperUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const desktop = document.querySelector('.desktop');
                    desktop.style.backgroundImage = `url(${e.target.result})`;
                    desktop.style.backgroundSize = 'cover';
                    desktop.style.backgroundPosition = 'center';
                    desktop.style.backgroundRepeat = 'no-repeat';
                };
                reader.readAsDataURL(file);
            }
        }

        function removeWallpaper() {
            const desktop = document.querySelector('.desktop');
            desktop.style.backgroundImage = 'none';
            desktop.style.background = document.getElementById('desktop-bg').value;
        }

        function applyPresetTheme(theme) {
            const themes = {
                classic: {
                    desktop: '#008080',
                    iconText: '#ffffff',
                    window: '#c0c0c0',
                    titleBar: '#000080',
                    taskbar: '#c0c0c0'
                },
                dark: {
                    desktop: '#1e1e1e',
                    iconText: '#ffffff',
                    window: '#2d2d2d',
                    titleBar: '#0078d7',
                    taskbar: '#2d2d2d'
                },
                green: {
                    desktop: '#2e4a2e',
                    iconText: '#ffffff',
                    window: '#c0d9c0',
                    titleBar: '#2e4a2e',
                    taskbar: '#4a6e4a'
                }
            };

            const selectedTheme = themes[theme];
            if (selectedTheme) {
                document.getElementById('desktop-bg').value = selectedTheme.desktop;
                document.getElementById('icon-text').value = selectedTheme.iconText;
                document.getElementById('window-bg').value = selectedTheme.window;
                document.getElementById('title-bar').value = selectedTheme.titleBar;
                document.getElementById('taskbar-bg').value = selectedTheme.taskbar;
                updateTheme();
            }
        }

        function resetTheme() {
            document.getElementById('desktop-bg').value = '#008080';
            document.getElementById('icon-text').value = '#ffffff';
            document.getElementById('window-bg').value = '#c0c0c0';
            document.getElementById('title-bar').value = '#000080';
            document.getElementById('taskbar-bg').value = '#c0c0c0';
            updateTheme();
        }

        // Internet Explorer Functions
        let currentUrl = 'about:blank';
        let history = ['about:blank'];
        let historyIndex = 0;
        let isLoading = false;

        function showHomePage() {
            document.getElementById('browserContent').innerHTML = `
                <div class="homepage">
                    <h1>Welcome to Internet Explorer</h1>
                    <p>The best way to experience the web.</p>
                    
                    <div class="favorites-section">
                        <h3>Quick Links</h3>
                        <a href="#" class="favorite-link" onclick="navigateTo('http://www.microsoft.com')">Microsoft Corporation</a>
                        <a href="#" class="favorite-link" onclick="navigateTo('http://www.msn.com')">MSN.com</a>
                        <a href="#" class="favorite-link" onclick="navigateTo('http://www.hotmail.com')">Hotmail</a>
                        <a href="#" class="favorite-link" onclick="navigateTo('http://www.windows.com')">Windows</a>
                    </div>
                    
                    <div class="favorites-section">
                        <h3>Search the Web</h3>
                        <input type="text" id="searchInput" placeholder="Enter search terms..." style="width: 300px; padding: 4px; margin-right: 10px;" onkeypress="handleSearchEnter(event)">
                        <button onclick="performSearch()" style="padding: 4px 12px;">Search</button>
                    </div>
                </div>
            `;
        }

        function performSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.trim();
            
            if (searchTerm) {
                const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(searchTerm)}`;
                navigateTo(searchUrl);
            }
        }

        function handleSearchEnter(event) {
            if (event.key === 'Enter') {
                performSearch();
            }
        }

        function navigateTo(url) {
            if (!url || url === 'about:blank') {
                showHomePage();
                currentUrl = 'about:blank';
                document.getElementById('addressInput').value = 'about:blank';
                return;
            }

            startLoading();
            currentUrl = url;
            document.getElementById('addressInput').value = url;
            
            // Add to history if it's a new navigation
            if (historyIndex === history.length - 1) {
                history.push(url);
                historyIndex++;
            }

            // Show the URL in an iframe
            setTimeout(() => {
                try {
                    document.getElementById('browserContent').innerHTML = `
                        <iframe src="${url}" class="browser-frame" onload="stopLoading()"></iframe>
                    `;
                } catch (e) {
                    showErrorPage(url);
                }
                stopLoading();
            }, 1000);
        }

        function navigate() {
            const addressInput = document.getElementById('addressInput');
            let url = addressInput.value.trim();
            
            if (!url) return;
            
            // Add protocol if missing
            if (!url.startsWith('http://') && !url.startsWith('https://') && !url.startsWith('about:')) {
                url = 'http://' + url;
            }
            
            navigateTo(url);
        }

        function handleAddressEnter(event) {
            if (event.key === 'Enter') {
                navigate();
            }
        }

        function startLoading() {
            isLoading = true;
            document.getElementById('statusText').textContent = 'Loading...';
            document.getElementById('loadingAnimation').style.display = 'block';
            document.getElementById('progressFill').style.width = '0%';
            
            // Simulate loading progress
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 20;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                }
                document.getElementById('progressFill').style.width = progress + '%';
            }, 100);
        }

        function stopLoading() {
            isLoading = false;
            document.getElementById('statusText').textContent = 'Done';
            document.getElementById('loadingAnimation').style.display = 'none';
            document.getElementById('progressFill').style.width = '100%';
            
            setTimeout(() => {
                document.getElementById('progressFill').style.width = '0%';
            }, 500);
        }

        function showErrorPage(url) {
            document.getElementById('browserContent').innerHTML = `
                <div class="error-page">
                    <div class="error-icon">!</div>
                    <h2>Internet Explorer cannot display the webpage</h2>
                    <p>The page you are looking for is currently unavailable.</p>
                    <p><strong>URL:</strong> ${url}</p>
                    <p>Please check the address and try again.</p>
                    <button onclick="goHome()" style="margin-top: 10px; padding: 4px 12px;">Go to Home Page</button>
                </div>
            `;
        }

        function goBack() {
            if (historyIndex > 0) {
                historyIndex--;
                navigateTo(history[historyIndex]);
            }
        }

        function goForward() {
            if (historyIndex < history.length - 1) {
                historyIndex++;
                navigateTo(history[historyIndex]);
            }
        }

        function goHome() {
            navigateTo('about:blank');
        }

        function refresh() {
            if (currentUrl) {
                navigateTo(currentUrl);
            }
        }

        function search() {
            const searchTerm = prompt('Enter search terms:');
            if (searchTerm) {
                const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(searchTerm)}`;
                navigateTo(searchUrl);
            }
        }

        function toggleDropdown(element) {
            const dropdown = element.parentElement;
            const isActive = dropdown.classList.contains('active');
            
            // Close all dropdowns
            document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
            
            // Toggle current dropdown
            if (!isActive) {
                dropdown.classList.add('active');
            }
        }

        // Placeholder functions for menu items
        function newWindow() { alert('New Window'); }
        function openFile() { alert('Open File'); }
        function saveAs() { alert('Save As'); }
        function print() { alert('Print'); }
        function cut() { alert('Cut'); }
        function copy() { alert('Copy'); }
        function paste() { alert('Paste'); }
        function selectAll() { alert('Select All'); }
        function find() { alert('Find'); }
        function viewSource() { alert('View Source'); }
        function fullScreen() { alert('Full Screen'); }
        function addToFavorites() { alert('Add to Favorites'); }
        function organizeFavorites() { alert('Organize Favorites'); }
        function internetOptions() { alert('Internet Options'); }
        function windowsUpdate() { alert('Windows Update'); }
        function showHelp() { alert('Help Topics'); }
        function aboutIE() { alert('About Internet Explorer\n\nVersion 5.0'); }
        function showFavorites() { alert('Favorites'); }
        function showHistory() { alert('History'); }
        function maximizeWindow(windowId) { alert('Maximize'); }

        // Initialize Internet Explorer
        document.addEventListener('DOMContentLoaded', function() {
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.dropdown')) {
                    document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
                }
            });

            // Show homepage when opening Boogle
            const boogleWindow = document.getElementById('boogle');
            if (boogleWindow) {
                showHomePage();
            }
        });

        // Vinyl Player Functions
        function initializeVinylPlayer() {
            let player, isPlaying = false, isPlayerReady = false, currentVideoId = null;
            const vinyl = document.querySelector('#vinyl-player .vinyl');
            const toneArm = document.querySelector('#vinyl-player .tone-arm');
            const playButton = document.querySelector('#vinyl-player .play-button');
            const progress = document.querySelector('#vinyl-player .progress');
            const timeDisplay = document.querySelector('#vinyl-player .time');
            const youtubeInput = document.querySelector('#vinyl-player #youtube-url');
            const loadMusicButton = document.querySelector('#vinyl-player #load-music');
            const statusDiv = document.querySelector('#vinyl-player #status');
            const songTitle = document.querySelector('#vinyl-player .song-info h2');
            const songArtist = document.querySelector('#vinyl-player .song-info p');
            const coverArt = document.querySelector('#vinyl-player .cover-art');
            const label = document.querySelector('#vinyl-player .label');
            const fullscreenButton = document.querySelector('#vinyl-player .fullscreen-button');
            const progressBar = document.querySelector('#vinyl-player .progress-bar');

            // Initialize grooves
            document.querySelector('#vinyl-player .grooves').innerHTML = [...Array(20)].map((_, i) => 
                `<div class="groove" style="transform:scale(${0.2+i*0.04})"></div>`
            ).join('');

            function showStatus(msg, type='info') {
                statusDiv.textContent = msg;
                statusDiv.className = `status ${type}`;
                statusDiv.style.display = 'block';
                if (type !== 'error') setTimeout(() => { statusDiv.style.display = 'none'; }, 3000);
            }

            function extractVideoId(url) {
                const m = url.match(/(?:youtube\.com.*(?:v=|\/v\/|embed\/)|youtu\.be\/)([^&\n?#]+)/);
                return m && m[1].length === 11 ? m[1] : null;
            }

            // Load YouTube IFrame API
            if (!window.YT) {
                const tag = document.createElement('script');
                tag.src = "https://www.youtube.com/iframe_api";
                document.body.appendChild(tag);
            }

            // Define the onYouTubeIframeAPIReady function globally
            window.onYouTubeIframeAPIReady = function() {
                player = new YT.Player('youtube-player', {
                    height: '315',
                    width: '560',
                    playerVars: { 
                        'playsinline': 1,
                        'controls': 0,
                        'enablejsapi': 1,
                        'origin': window.location.origin
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange,
                        'onError': onPlayerError
                    }
                });
                showStatus("YouTube API loaded", 'success');
            };

            function onPlayerReady() {
                isPlayerReady = true;
                showStatus("Player ready", 'success');
                playButton.disabled = false;
                fullscreenButton.disabled = false;
            }

            function onPlayerError(event) {
                showStatus(`Error: ${event.data}`, 'error');
                playButton.disabled = true;
            }

            function onPlayerStateChange(event) {
                switch (event.data) {
                    case YT.PlayerState.PLAYING:
                        isPlaying = true;
                        vinyl.classList.add('playing');
                        toneArm.classList.add('playing');
                        playButton.textContent = '‚è∏';
                        updateProgress();
                        if (currentVideoId) {
                            updateMetadata(currentVideoId);
                        }
                        break;
                    case YT.PlayerState.PAUSED:
                    case YT.PlayerState.ENDED:
                        isPlaying = false;
                        vinyl.classList.remove('playing');
                        toneArm.classList.remove('playing');
                        playButton.textContent = '‚ñ∂';
                        updateToneArm(0);
                        break;
                }
            }

            function updateToneArm(progressPercent) {
                if (progressPercent === 0) {
                    toneArm.style.transform = 'rotate(-60deg)';
                    toneArm.querySelector('.tone-arm-body').style.transform = 'rotate(-45deg)';
                } else {
                    const armAngle = -60 + (progressPercent * 30);
                    const bodyAngle = -45 + (progressPercent * 35);
                    toneArm.style.transform = `rotate(${armAngle}deg)`;
                    toneArm.querySelector('.tone-arm-body').style.transform = `rotate(${bodyAngle}deg)`;
                }
            }

            function handleScrub(e) {
                if (!player || !isPlayerReady) return;
                
                const rect = progressBar.getBoundingClientRect();
                const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
                const time = percent * player.getDuration();
                
                player.seekTo(time, true);
                updateProgress();
                updateToneArm(percent);
            }

            let lastScrollTime = 0;
            const scrollThrottle = 50;

            function handleWheel(e) {
                if (!player || !isPlayerReady) return;
                e.preventDefault();
                
                const now = Date.now();
                if (now - lastScrollTime < scrollThrottle) return;
                lastScrollTime = now;

                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const scrollAmount = e.deltaY > 0 ? 2 : -2;
                const newTime = Math.max(0, Math.min(duration, currentTime + scrollAmount));
                
                player.seekTo(newTime, true);
                const progressPercent = newTime / duration;
                updateProgress();
                updateToneArm(progressPercent);
            }

            function updateProgress() {
                if (!player || !isPlayerReady) return;
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const progressPercent = (currentTime / duration) * 100;
                progress.style.width = `${progressPercent}%`;
                timeDisplay.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
                updateToneArm(currentTime / duration);
                if (isPlaying) {
                    requestAnimationFrame(updateProgress);
                }
            }

            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                seconds = Math.floor(seconds % 60);
                return `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }

            function toggleFullscreen() {
                const playerElement = document.querySelector('#vinyl-player .player');
                if (!document.fullscreenElement) {
                    playerElement.requestFullscreen().catch(err => {
                        showStatus('Error attempting to enable fullscreen: ' + err.message, 'error');
                    });
                } else {
                    document.exitFullscreen();
                }
            }

            document.addEventListener('fullscreenchange', () => {
                const playerElement = document.querySelector('#vinyl-player .player');
                if (document.fullscreenElement) {
                    playerElement.classList.add('fullscreen');
                    fullscreenButton.textContent = '‚Ææ';
                } else {
                    playerElement.classList.remove('fullscreen');
                    fullscreenButton.textContent = '‚õ∂';
                }
            });

            playButton.addEventListener('click', () => {
                if (!player || !isPlayerReady) {
                    showStatus("Player not ready yet", "error");
                    return;
                }
                if (isPlaying) {
                    player.pauseVideo();
                } else {
                    player.playVideo();
                }
            });

            loadMusicButton.addEventListener('click', () => {
                const url = youtubeInput.value.trim();
                const id = extractVideoId(url);
                if (!id) {
                    showStatus("Invalid YouTube URL", "error");
                    return;
                }
                if (!isPlayerReady) {
                    showStatus("Player not ready yet", "error");
                    return;
                }
                currentVideoId = id;
                player.loadVideoById(id);
                playButton.disabled = false;
                updateMetadata(id);
            });

            function updateMetadata(id) {
                const thumb = `https://img.youtube.com/vi/${id}/hqdefault.jpg`;
                coverArt.src = thumb;
                label.style.backgroundImage = `url('${thumb}')`;
                
                if (player && player.getVideoData) {
                    const videoData = player.getVideoData();
                    if (videoData) {
                        songTitle.textContent = videoData.title || 'Unknown Title';
                        const titleParts = videoData.title.split(' - ');
                        if (titleParts.length > 1) {
                            songArtist.textContent = titleParts[0];
                            songTitle.textContent = titleParts.slice(1).join(' - ');
                        } else {
                            songArtist.textContent = videoData.author || 'Unknown Artist';
                        }
                    }
                }
            }

            vinyl.addEventListener('click', () => {
                if (!player || !isPlayerReady) {
                    showStatus("Player not ready yet", "error");
                    return;
                }
                if (isPlaying) {
                    player.pauseVideo();
                } else {
                    player.playVideo();
                }
            });

            progressBar.addEventListener('click', handleScrub);
            document.addEventListener('wheel', handleWheel, { passive: false });
            fullscreenButton.addEventListener('click', toggleFullscreen);

            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space' && e.target !== youtubeInput) {
                    e.preventDefault();
                    if (player && isPlayerReady) {
                        if (isPlaying) {
                            player.pauseVideo();
                        } else {
                            player.playVideo();
                        }
                    }
                }
            });

            updateToneArm(0);
            showStatus("Initializing player...", 'info');
        }

        function triggerConfetti() {
            const duration = 3 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);
                
                // since particles fall down, start a bit higher than random
                confetti({
                    ...defaults,
                    particleCount,
                    origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 }
                });
                confetti({
                    ...defaults,
                    particleCount,
                    origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 }
                });
            }, 250);
        }
    </script>
</body>
</html>